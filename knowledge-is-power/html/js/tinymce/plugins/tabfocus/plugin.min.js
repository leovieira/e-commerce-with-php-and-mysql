tinymce.PluginManager.add("tabfocus",function(e){function n(e){9===e.keyCode&&e.preventDefault()}function t(n){function t(n){function t(e){return"BODY"===e.nodeName||"hidden"!=e.type&&"none"!=e.style.display&&"hidden"!=e.style.visibility&&t(e.parentNode)}function r(e){return e.attributes.tabIndex.specified||"INPUT"==e.nodeName||"TEXTAREA"==e.nodeName}function d(e){return!r(e)&&"-1"!=e.getAttribute("tabindex")&&t(e)}if(a=i.select(":input:enabled,*[tabindex]:not(iframe)"),o(a,function(n,t){if(n.id==e.id)return u=t,!1}),n>0){for(c=u+1;c<a.length;c++)if(d(a[c]))return a[c]}else for(c=u-1;c>=0;c--)if(d(a[c]))return a[c];return null}var u,a,d,c;9===n.keyCode&&(d=r(e.getParam("tab_focus",e.getParam("tabfocus_elements",":prev,:next"))),1==d.length&&(d[1]=d[0],d[0]=":prev"),(a=n.shiftKey?":prev"==d[0]?t(-1):i.get(d[0]):":next"==d[1]?t(1):i.get(d[1]))&&(a.id&&(e=tinymce.get(a.id||a.name))?e.focus():window.setTimeout(function(){tinymce.Env.webkit||window.focus(),a.focus()},10),n.preventDefault()))}var i=tinymce.DOM,o=tinymce.each,r=tinymce.explode;e.on("keyup",n),tinymce.Env.gecko?e.on("keypress keydown",t):e.on("keydown",t)});